/* src/content/styles/contentActions.shadow.css */
/* Shadow DOM compatible styles for Content Actions component */
/* 
 * Color Variables: These are injected from src/constants/colors.css.ts
 * NEVER use hardcoded hex or rgba values - always use CSS variables
 * ALL properties use !important for Shadow DOM style isolation
 */

:host {
  all: initial !important;
  font-family: var(--font-family-primary) !important;
}

* {
  box-sizing: border-box !important;
}

/* Color variable fallbacks */
:host {
  --color-primary: #0d8070 !important;
  --color-primary-light: #14a08a !important;
  --color-primary-very-light: #e0f2ef !important;
  --color-primary-dark: #0a5f54 !important;
  --color-primary-opacity-20: rgba(13, 128, 112, 0.2) !important;
  --color-white: #FFFFFF !important;
  --color-secondary-medium: #34D399 !important;
  --color-secondary-light: #D1FAE5 !important;
}

/* Main container */
.contentActionsContainer {
  display: flex !important;
  align-items: center !important;
  pointer-events: auto !important;
}

/* Xplaino Icon Button */
.xplainoIconButton {
  width: 14px !important;
  height: 14px !important;
  border-radius: 0 !important;
  background: transparent !important;
  border: none !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 0 !important;
  outline: none !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  transform: translateX(-50%) scale(0);
  opacity: 0;
  visibility: hidden !important;
  box-shadow: none !important;
}

.xplainoIconButton.visible {
  visibility: visible !important;
  opacity: 1;
  transform: translateX(-50%) scale(1);
  animation: iconButtonEmerge 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.xplainoIconButton.hidden {
  visibility: visible !important;
  pointer-events: none !important;
  animation: iconButtonShrink 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards !important;
}

/* Ensure icon stays non-interactive when button group is visible to prevent hover conflicts */
.contentActionsContainer:has(.contentActionsButtonGroup.visible) .xplainoIconButton {
  pointer-events: none !important;
}

.xplainoIcon {
  width: 14px !important;
  height: 14px !important;
  object-fit: contain !important;
  display: block !important;
  pointer-events: none !important;
  margin: auto !important;
  flex-shrink: 0 !important;
}

/* Button Group - Pill shaped */
.contentActionsButtonGroup {
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;

  background: var(--color-bg-primary-theme) !important;
  border-radius: 999px !important;
  padding: 1px !important;
  border: 1.5px solid var(--color-border-default-theme) !important;
  opacity: 0 !important;
  visibility: hidden !important;
  transform: translateX(-19px) translateY(-9px) !important;
  width: var(--button-group-width, 0px) !important;
  max-width: 500px !important;
  overflow: hidden !important; /* Clip icons during width animation */
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.1s ease 0.35s, visibility 0s ease 0.4s !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  transform-origin: left center !important;
  white-space: nowrap !important;
  pointer-events: none !important;
}

.contentActionsButtonGroup.visible {
  opacity: 1 !important;
  visibility: visible !important;
  transform: translateX(-19px) translateY(-9px) !important;
  /* Width will be set via CSS variable by JavaScript */
  max-width: 500px !important;
  overflow: hidden !important; /* Keep hidden during expansion for progressive reveal */
  will-change: width !important;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.1s ease, visibility 0s ease !important;
  pointer-events: auto !important;
}

/* Closing state - keeps visible during width shrink animation */
.contentActionsButtonGroup.closing {
  visibility: visible !important;
  overflow: hidden !important;
  animation: buttonGroupClose 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards !important;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

/* Keyframe animation for closing - synced with width shrink */
@keyframes buttonGroupClose {
  0% {
    opacity: 1;
    padding: 1px;
    border-width: 1.5px;
  }
  70% {
    opacity: 1;
    padding: 1px;
    border-width: 1.5px;
  }
  90% {
    opacity: 0;
    padding: 0.5px;
    border-width: 0.5px;
  }
  100% {
    opacity: 0;
    padding: 0;
    border-width: 0;
    visibility: hidden;
  }
}

/* Allow tooltips after animation completes */
.contentActionsButtonGroup.visible.animationComplete {
  overflow: visible !important;
}

/* Action Button Wrapper (for tooltip positioning) */
.contentActionButtonWrapper {
  position: relative !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* Individual Action Button - Square shape with rounded corners */
.contentActionButton {
  width: 26px !important;
  height: 26px !important;
  border-radius: 3px !important;
  background: transparent !important;
  border: none !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 0 !important;
  margin: 2px !important; /* Add margin around buttons */
  outline: none !important;
  /* Initial hidden state */
  opacity: 0 !important;
  transform: translateX(-10px) scale(0.8) !important;
  pointer-events: none !important;
  visibility: hidden !important;
  /* Transition for smooth appearance */
  transition: opacity 0.2s ease, transform 0.2s ease !important;
}

.contentActionsButtonGroup.visible .contentActionButton {
  pointer-events: auto !important;
  visibility: visible !important;
  display: flex !important;
  min-width: 26px !important;
  min-height: 26px !important;
  /* Visible state - transition will animate these */
  opacity: 1 !important;
  transform: translateX(0) scale(1) !important;
}

/* First button (AI explanation) appears immediately without delay */
.contentActionsButtonGroup.visible .contentActionButton:first-child {
  transition: opacity 0.1s ease, transform 0.1s ease !important;
  transition-delay: 0s !important;
}

.contentActionButton:hover {
  background: var(--color-hover-bg-action-theme) !important;
}

.contentActionButton:active {
  transform: scale(0.92) !important;
}

/* Action Button Icons */
.contentActionButton svg {
  width: 15px !important;
  height: 15px !important;
  color: var(--color-primary-light) !important;
  stroke: var(--color-primary-light) !important;
  stroke-width: 2.5 !important;
  fill: none !important;
  pointer-events: none !important;
  display: block !important;
  flex-shrink: 0 !important;
  /* Icons inherit visibility from parent button */
  opacity: 1 !important;
  transform: none !important;
}

.contentActionsButtonGroup.visible .contentActionButton svg {
  visibility: visible !important;
  display: block !important;
}

.contentActionButton:hover svg {
  color: var(--color-primary) !important;
  stroke: var(--color-primary) !important;
}

/* First button - left side matches pill shape */
.contentActionsButtonGroup .contentActionButtonWrapper:first-child .contentActionButton {
  border-top-left-radius: 999px !important;
  border-bottom-left-radius: 999px !important;
  border-top-right-radius: 3px !important;
  border-bottom-right-radius: 3px !important;
}

/* Last button - right side matches pill shape */
.contentActionsButtonGroup .contentActionButtonWrapper:last-child .contentActionButton {
  border-top-right-radius: 999px !important;
  border-bottom-right-radius: 999px !important;
  border-top-left-radius: 3px !important;
  border-bottom-left-radius: 3px !important;
}

/* Handle options button wrapper (last child in button group) */
.contentActionsButtonGroup > .optionsButtonWrapper:last-child .contentActionButton {
  border-top-right-radius: 999px !important;
  border-bottom-right-radius: 999px !important;
  border-top-left-radius: 3px !important;
  border-bottom-left-radius: 3px !important;
}


/* Animations */
@keyframes buttonScaleIn {
  from {
    opacity: 0 !important;
    transform: scale(0) !important; /* Start at 0px dimension */
  }
  to {
    opacity: 1 !important;
    transform: scale(1) !important; /* Grow to final radius size (26px) */
  }
}

@keyframes iconScaleIn {
  from {
    opacity: 0 !important;
    transform: scale(0) !important; /* Start at 0px dimension */
  }
  to {
    opacity: 1 !important;
    transform: scale(1) !important; /* Grow to full size */
  }
}

/* Progressive reveal animation - buttons slide in from left as width expands */
@keyframes buttonSlideReveal {
  from {
    opacity: 0 !important;
    transform: translateX(-15px) scale(0.6) !important; /* Start offset to the left and smaller */
  }
  to {
    opacity: 1 !important;
    transform: translateX(0) scale(1) !important; /* Slide to final position and full size */
  }
}

/* Icon slide reveal - synced with button animation */
@keyframes iconSlideReveal {
  from {
    opacity: 0 !important;
    transform: translateX(-10px) scale(0.6) !important;
  }
  to {
    opacity: 1 !important;
    transform: translateX(0) scale(1) !important;
  }
}

/* Icon button emerge animation */
@keyframes iconButtonEmerge {
  0% {
    opacity: 0;
    transform: translateX(-50%) scale(0);
  }
  100% {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
}

/* Icon button shrink animation */
@keyframes iconButtonShrink {
  from {
    opacity: 1;
    transform: translateX(-50%) scale(1);
  }
  to {
    opacity: 0;
    transform: translateX(-50%) scale(0);
  }
}


/* Options Button Wrapper */
.optionsButtonWrapper {
  position: relative !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* Action Button Options Popover */
.actionButtonOptionsPopover {
  position: absolute !important;
  top: calc(100% + 8px) !important;
  left: 50% !important;
  margin-left: -60px !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 2px !important;
  background: var(--color-bg-primary-theme) !important;
  border-radius: 15px !important;
  padding: 4px !important;
  border: 1.5px solid var(--color-border-default-theme) !important;
  /* Animation is handled by JavaScript useEmergeAnimation hook */
  z-index: 20 !important;
  width: fit-content !important;
  min-width: 120px !important;
  /* Initial hidden state - prevents flash before animation starts */
  /* No !important so inline styles and Web Animations API can override */
  transform: scale(0);
  transform-origin: top center;
}

.actionButtonOptionsPopover::before {
  content: '' !important;
  position: absolute !important;
  bottom: 100% !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  border: 6px solid transparent !important;
  border-bottom-color: var(--color-bg-primary-theme) !important;
}

/* Action Button Option Button */
.actionButtonOption {
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
  padding: 6px 10px !important;
  background: transparent !important;
  border: none !important;
  border-radius: 10px !important;
  cursor: pointer !important;
  font-size: 12px !important;
  font-weight: 500 !important;
  color: var(--color-primary-light) !important;
  white-space: nowrap !important;
  transition: all 0.15s ease !important;
  text-align: left !important;
  width: 100% !important;
}

.actionButtonOption:hover {
  background: var(--color-hover-bg-action-theme) !important;
  color: var(--color-primary) !important;
}

.actionButtonOption:active {
  transform: scale(0.98) !important;
}

.actionButtonOption svg {
  width: 14px !important;
  height: 14px !important;
  color: inherit !important;
  stroke: currentColor !important;
  stroke-width: 2.5 !important;
  fill: none !important;
  flex-shrink: 0 !important;
}

.actionButtonOption span {
  flex: 1 !important;
}

/* Disable Popover */
.disablePopover {
  position: absolute !important;
  top: calc(100% + 8px) !important;
  left: 50% !important;
  margin-left: -60px !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 2px !important;
  background: var(--color-bg-primary-theme) !important;
  border-radius: 15px !important;
  padding: 4px !important;
  border: 1.5px solid var(--color-border-default-theme) !important;
  box-shadow: none !important;
  /* Animation is handled by JavaScript useEmergeAnimation hook */
  z-index: 20 !important;
  width: fit-content !important;
  /* Initial hidden state - prevents flash before animation starts */
  /* No !important so inline styles and Web Animations API can override */
  transform: scale(0);
  transform-origin: top right;
}

.disablePopover::before {
  content: '' !important;
  position: absolute !important;
  bottom: 100% !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  border: 6px solid transparent !important;
  border-bottom-color: var(--color-bg-primary-theme) !important;
}

/* Disable Popover Option Button */
.disablePopoverOption {
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  padding: 8px 12px !important;
  background: transparent !important;
  border: none !important;
  border-radius: 10px !important;
  cursor: pointer !important;
  font-size: 13px !important;
  font-weight: 500 !important;
  color: var(--color-primary-light) !important;
  white-space: nowrap !important;
  transition: all 0.15s ease !important;
  text-align: left !important;
  width: auto !important;
}

.disablePopoverOption:hover {
  background: var(--color-hover-bg-action-theme) !important;
  color: var(--color-primary) !important;
}

.disablePopoverOption:active {
  transform: scale(0.98) !important;
}

.disablePopoverOption svg {
  width: 14px !important;
  height: 14px !important;
  color: inherit !important;
  stroke: currentColor !important;
  stroke-width: 2.5 !important;
  fill: none !important;
  flex-shrink: 0 !important;
}

.disablePopoverOption span {
  flex: 1 !important;
}

/* Popover fade in animation (from above) */
@keyframes popoverFadeIn {
  from {
    opacity: 0 !important;
    transform: translateY(4px) !important;
  }
  to {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
}

/* Popover fade in animation (from below - for dropdown) */
@keyframes popoverFadeInDown {
  from {
    opacity: 0 !important;
    transform: translateY(-4px) !important;
  }
  to {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
}

/* ============================================
   EMERGE/SHRINK ANIMATIONS
   Generic animations for components that appear 
   from a source element while growing, and 
   disappear back into the source while shrinking.
   ============================================ */

/* Emerge out animation keyframes (fallback for CSS-only usage) */
@keyframes emergeOut {
  from {
    opacity: 0 !important;
    transform: var(--emerge-start-transform, scale(0) translate(0, 0)) !important;
  }
  to {
    opacity: 1 !important;
    transform: var(--emerge-end-transform, scale(1) translate(0, 0)) !important;
  }
}

/* Shrink in animation keyframes (fallback for CSS-only usage) */
@keyframes shrinkIn {
  from {
    opacity: 1 !important;
    transform: var(--shrink-start-transform, scale(1) translate(0, 0)) !important;
  }
  to {
    opacity: 0 !important;
    transform: var(--shrink-end-transform, scale(0) translate(0, 0)) !important;
  }
}

/* Emerge animation class */
.emerge-animation {
  animation: emergeOut var(--emerge-duration, 200ms) var(--emerge-easing, cubic-bezier(0.4, 0, 0.2, 1)) forwards !important;
}

/* Shrink animation class */
.shrink-animation {
  animation: shrinkIn var(--shrink-duration, 200ms) var(--shrink-easing, cubic-bezier(0.4, 0, 0.2, 1)) forwards !important;
}
